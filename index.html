<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Thang ƒëi·ªÉm FoMO s·ªõm</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --primary: #2563eb;
      --primary-soft: #eff6ff;
      --primary-dark: #1d4ed8;
      --accent: #f97316;
      --text-main: #0f172a;
      --text-muted: #6b7280;
      --border: #e5e7eb;
      --bg: #f3f4f6;
      --card-bg: #ffffff;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: var(--bg);
      color: var(--text-main);
      display: flex;
      justify-content: center;
    }

    .page-shell {
      flex: 1;
      max-width: 900px;
      margin: 16px auto;
      padding: 12px;
    }

    /* HEADER ƒë∆°n gi·∫£n, n·ªÅn tr·∫Øng */
    .header {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 14px 16px;
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.06);
      border: 1px solid rgba(148, 163, 184, 0.35);
      margin-bottom: 12px;
    }

    .header-title {
      font-size: 20px;
      font-weight: 700;
      margin: 0 0 4px;
      color: var(--primary-dark);
    }

    .header-sub {
      font-size: 13px;
      color: var(--text-muted);
      margin: 0 0 8px;
    }

    .tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .tag {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--primary-soft);
      color: var(--primary-dark);
      border: 1px solid #bfdbfe;
    }

    /* CARD ch√≠nh */
    .card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
      border: 1px solid rgba(148, 163, 184, 0.35);
    }

    .card-header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 700;
    }

    .card-subtitle {
      font-size: 13px;
      color: var(--text-muted);
    }

    .badge-small {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      border: 1px solid #c7d2fe;
    }

    /* Tabs */
    .tabs {
      display: inline-flex;
      border-radius: 999px;
      background: #e5e7eb;
      padding: 3px;
      margin-bottom: 10px;
      margin-top: 4px;
    }

    .tab {
      border-radius: 999px;
      border: none;
      padding: 7px 16px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      color: #4b5563;
      background: transparent;
      transition: all 0.15s ease;
      min-width: 90px;
    }

    .tab.active {
      background: #ffffff;
      color: var(--primary-dark);
      box-shadow: 0 3px 8px rgba(148, 163, 184, 0.6);
    }

    /* Info ng∆∞·ªùi l√†m */
    .info-row {
      margin: 10px 0 14px;
      padding: 10px 12px;
      border-radius: 12px;
      background: var(--primary-soft);
      border: 1px solid #bfdbfe;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
    }

    .info-row label {
      font-size: 13px;
      font-weight: 500;
      color: #1f2933;
    }

    .info-input {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #cbd5f5;
      min-width: 90px;
      font-size: 13px;
      outline: none;
    }

    .info-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
    }

    .info-hint {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* Sections */
    h2 {
      font-size: 16px;
      margin: 18px 0 4px;
      color: #111827;
    }

    .section-desc {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 8px;
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 12px;
      font-size: 13px;
      background: #ffffff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.03);
    }

    th,
    td {
      border: 1px solid var(--border);
      padding: 8px 6px;
      text-align: left;
      vertical-align: middle;
    }

    th {
      background: #f3f4f6;
      font-weight: 600;
      text-align: center;
    }

    td.center {
      text-align: center;
    }

    tbody tr:nth-child(even) {
      background: #f9fafb;
    }

    /* Note */
    .scale-note {
      font-size: 12px;
      color: #4b5563;
      background: #f9fafb;
      border-radius: 12px;
      padding: 10px 12px;
      border: 1px dashed var(--border);
      margin: 6px 0 16px;
    }

    /* Buttons */
    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 4px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      border-radius: 999px;
      border: none;
      padding: 9px 16px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.12s, box-shadow 0.12s, background 0.12s;
      white-space: nowrap;
    }

    .btn-primary {
      background: var(--primary);
      color: #ffffff;
      box-shadow: 0 10px 20px rgba(37, 99, 235, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(37, 99, 235, 0.5);
    }

    .btn-ghost {
      background: #f3f4f6;
      color: #374151;
      border: 1px solid #e5e7eb;
    }

    .btn-ghost:hover {
      background: #e5e7eb;
      transform: translateY(-1px);
    }

    /* Result */
    .result {
      margin-top: 14px;
      padding: 12px 14px;
      border-radius: 14px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      display: none;
    }

    .result-title {
      font-weight: 700;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .result-score {
      font-weight: 600;
      margin-bottom: 4px;
      font-size: 13px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 600;
      margin-left: 4px;
      border: 1px solid transparent;
    }

    .badge-low {
      background: #dcfce7;
      color: #166534;
      border-color: #bbf7d0;
    }

    .badge-medium {
      background: #fef9c3;
      color: #854d0e;
      border-color: #fef08a;
    }

    .badge-high {
      background: #fee2e2;
      color: #b91c1c;
      border-color: #fecaca;
    }

    /* History */
    .history-empty {
      font-size: 13px;
      color: #6b7280;
      font-style: italic;
      margin-top: 8px;
    }

    .history-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 8px;
      background: #ffffff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.03);
    }

    .history-table th,
    .history-table td {
      border: 1px solid var(--border);
      padding: 6px 6px;
      text-align: left;
    }

    .history-table th {
      background: #e5e7eb;
      font-weight: 600;
      text-align: center;
    }

    .footer-note {
      margin-top: 10px;
      font-size: 11px;
      color: #6b7280;
      text-align: center;
    }

    @media (max-width: 680px) {
      .page-shell {
        margin: 8px auto 16px;
        padding: 8px;
      }
      .card {
        padding: 14px;
      }
      table,
      .history-table {
        font-size: 11px;
      }
      th,
      td {
        padding: 6px 4px;
      }
      .btn-row {
        flex-direction: column;
        align-items: stretch;
      }
      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="page-shell">
    <!-- HEADER -->
    <header class="header">
      <h1 class="header-title">Thang ƒëi·ªÉm FoMO s·ªõm</h1>
      <p class="header-sub">
        C√¥ng c·ª• s√†ng l·ªçc s·ªõm m·ª©c ƒë·ªô Fear of Missing Out (FoMO) khi s·ª≠ d·ª•ng m·∫°ng x√£ h·ªôi. K·∫øt qu·∫£ h·ªó tr·ª£ gi√°o vi√™n &amp; ph·ª• huynh.
      </p>
      <div class="tags">
        <span class="tag">10 c√¢u h·ªèi ¬∑ 3‚Äì5 ph√∫t</span>
        <span class="tag">L∆∞u l·ªãch s·ª≠ tr√™n tr√¨nh duy·ªát</span>
        <span class="tag">G·ª≠i t√™n + l·ªõp l√™n Google Sheets</span>
      </div>
    </header>

    <!-- CARD CH√çNH -->
    <main class="card">
      <div class="card-header-row">
        <div>
          <div class="card-title">B√†i kh·∫£o s√°t FoMO</div>
          <div class="card-subtitle">Ch·ªçn m·ª©c ƒë·ªô ph√π h·ª£p v·ªõi th√≥i quen c·ªßa b·∫°n.</div>
        </div>
        <span class="badge-small">Phi√™n b·∫£n cho l·ªõp h·ªçc</span>
      </div>

      <!-- Tabs -->
      <div class="tabs">
        <button type="button" class="tab active" id="tab-test" onclick="switchTab('test')">
          B√†i test
        </button>
        <button type="button" class="tab" id="tab-history" onclick="switchTab('history')">
          L·ªãch s·ª≠
        </button>
      </div>

      <!-- PANEL TEST -->
      <section id="panel-test">
        <form id="fomoForm">
          <!-- Ng∆∞·ªùi l√†m: H·ªç t√™n + L·ªõp -->
          <div class="info-row">
            <label style="margin-right: 8px;">
              H·ªç t√™n:
              <input
                type="text"
                id="studentName"
                class="info-input"
                placeholder="VD: Nguy·ªÖn VƒÉn A"
                style="min-width: 130px;"
              />
            </label>
            <label>
              L·ªõp:
              <input
                type="text"
                id="studentClass"
                class="info-input"
                placeholder="VD: 10A1"
              />
            </label>
            <div class="info-hint">
              T√™n + l·ªõp s·∫Ω ƒë∆∞·ª£c ghi v√†o Google Sheets c·ªßa gi√°o vi√™n.
            </div>
          </div>

          <!-- A -->
          <h2>A. Nh√≥m h√†nh vi s·ª≠ d·ª•ng m·∫°ng x√£ h·ªôi</h2>
          <p class="section-desc">
            Ch·ªçn theo th√≥i quen trong <strong>1‚Äì2 th√°ng g·∫ßn ƒë√¢y</strong>.
          </p>
          <table>
            <tr>
              <th style="width: 40px">STT</th>
              <th>Ch·ªâ b√°o h√†nh vi</th>
              <th style="width: 115px">Kh√¥ng bao gi·ªù / r·∫•t hi·∫øm<br /><span style="font-weight: 400">(0 ƒëi·ªÉm)</span></th>
              <th style="width: 105px">Th·ªânh tho·∫£ng<br /><span style="font-weight: 400">(1 ƒëi·ªÉm)</span></th>
              <th style="width: 125px">Th∆∞·ªùng xuy√™n ‚Äì h·∫±ng ng√†y<br /><span style="font-weight: 400">(2 ƒëi·ªÉm)</span></th>
            </tr>
            <tr>
              <td class="center">1</td>
              <td>Ki·ªÉm tra ƒëi·ªán tho·∫°i li√™n t·ª•c</td>
              <td class="center"><input type="radio" name="q1" value="0" /></td>
              <td class="center"><input type="radio" name="q1" value="1" /></td>
              <td class="center"><input type="radio" name="q1" value="2" /></td>
            </tr>
            <tr>
              <td class="center">2</td>
              <td>Xem Story v·ªõi t·∫ßn su·∫•t cao (&gt;20 l·∫ßn/ng√†y)</td>
              <td class="center"><input type="radio" name="q2" value="0" /></td>
              <td class="center"><input type="radio" name="q2" value="1" /></td>
              <td class="center"><input type="radio" name="q2" value="2" /></td>
            </tr>
            <tr>
              <td class="center">3</td>
              <td>S·ª≠ d·ª•ng m·∫°ng x√£ h·ªôi sau 23h</td>
              <td class="center"><input type="radio" name="q3" value="0" /></td>
              <td class="center"><input type="radio" name="q3" value="1" /></td>
              <td class="center"><input type="radio" name="q3" value="2" /></td>
            </tr>
            <tr>
              <td class="center">4</td>
              <td>D√†nh nhi·ªÅu th·ªùi gian tr√™n m·∫°ng x√£ h·ªôi (&gt;3 gi·ªù/ng√†y)</td>
              <td class="center"><input type="radio" name="q4" value="0" /></td>
              <td class="center"><input type="radio" name="q4" value="1" /></td>
              <td class="center"><input type="radio" name="q4" value="2" /></td>
            </tr>
            <tr>
              <td class="center">5</td>
              <td>Ki·ªÉm tra ngay khi c√≥ th√¥ng b√°o</td>
              <td class="center"><input type="radio" name="q5" value="0" /></td>
              <td class="center"><input type="radio" name="q5" value="1" /></td>
              <td class="center"><input type="radio" name="q5" value="2" /></td>
            </tr>
          </table>

          <!-- B -->
          <h2>B. Nh√≥m c·∫£m x√∫c ‚Äì nh·∫≠n th·ª©c</h2>
          <table>
            <tr>
              <th style="width: 40px">STT</th>
              <th>Ch·ªâ b√°o c·∫£m x√∫c ‚Äì nh·∫≠n th·ª©c</th>
              <th style="width: 115px">Kh√¥ng bao gi·ªù / r·∫•t hi·∫øm<br /><span style="font-weight: 400">(0 ƒëi·ªÉm)</span></th>
              <th style="width: 105px">Th·ªânh tho·∫£ng<br /><span style="font-weight: 400">(1 ƒëi·ªÉm)</span></th>
              <th style="width: 125px">Th∆∞·ªùng xuy√™n<br /><span style="font-weight: 400">(2 ƒëi·ªÉm)</span></th>
            </tr>
            <tr>
              <td class="center">6</td>
              <td>Lo l·∫Øng / kh√≥ ch·ªãu khi m·∫•t m·∫°ng</td>
              <td class="center"><input type="radio" name="q6" value="0" /></td>
              <td class="center"><input type="radio" name="q6" value="1" /></td>
              <td class="center"><input type="radio" name="q6" value="2" /></td>
            </tr>
            <tr>
              <td class="center">7</td>
              <td>√Åp l·ª±c ph·∫£i ph·∫£n h·ªìi tin nh·∫Øn ngay</td>
              <td class="center"><input type="radio" name="q7" value="0" /></td>
              <td class="center"><input type="radio" name="q7" value="1" /></td>
              <td class="center"><input type="radio" name="q7" value="2" /></td>
            </tr>
            <tr>
              <td class="center">8</td>
              <td>So s√°nh b·∫£n th√¢n v·ªõi b·∫°n b√® tr√™n m·∫°ng x√£ h·ªôi</td>
              <td class="center"><input type="radio" name="q8" value="0" /></td>
              <td class="center"><input type="radio" name="q8" value="1" /></td>
              <td class="center"><input type="radio" name="q8" value="2" /></td>
            </tr>
            <tr>
              <td class="center">9</td>
              <td>S·ª£ b·ªã t·ª•t h·∫≠u / b·ªè l·ª° th√¥ng tin</td>
              <td class="center"><input type="radio" name="q9" value="0" /></td>
              <td class="center"><input type="radio" name="q9" value="1" /></td>
              <td class="center"><input type="radio" name="q9" value="2" /></td>
            </tr>
          </table>

          <!-- C -->
          <h2>C. Nh√≥m h·ªá qu·∫£ h·ªçc t·∫≠p</h2>
          <table>
            <tr>
              <th style="width: 40px">STT</th>
              <th>Ch·ªâ b√°o h·ªá qu·∫£</th>
              <th style="width: 115px">Kh√¥ng bao gi·ªù / r·∫•t hi·∫øm<br /><span style="font-weight: 400">(0 ƒëi·ªÉm)</span></th>
              <th style="width: 105px">Th·ªânh tho·∫£ng<br /><span style="font-weight: 400">(1 ƒëi·ªÉm)</span></th>
              <th style="width: 125px">Th∆∞·ªùng xuy√™n ‚Äì h·∫±ng ng√†y<br /><span style="font-weight: 400">(2 ƒëi·ªÉm)</span></th>
            </tr>
            <tr>
              <td class="center">10</td>
              <td>Xao nh√£ng vi·ªác h·ªçc do s·ª≠ d·ª•ng m·∫°ng x√£ h·ªôi</td>
              <td class="center"><input type="radio" name="q10" value="0" /></td>
              <td class="center"><input type="radio" name="q10" value="1" /></td>
              <td class="center"><input type="radio" name="q10" value="2" /></td>
            </tr>
          </table>

          <div class="scale-note">
            <strong>C√°ch ch·∫•m ƒëi·ªÉm:</strong><br />
            ‚Äì Kh√¥ng bao gi·ªù / r·∫•t hi·∫øm (0‚Äì1 l·∫ßn/tu·∫ßn): <strong>0 ƒëi·ªÉm</strong><br />
            ‚Äì Th·ªânh tho·∫£ng (1‚Äì3 l·∫ßn/tu·∫ßn): <strong>1 ƒëi·ªÉm</strong><br />
            ‚Äì Th∆∞·ªùng xuy√™n (h·∫±ng ng√†y ho·∫∑c nhi·ªÅu l·∫ßn/ng√†y): <strong>2 ƒëi·ªÉm</strong><br /><br />
            <strong>T·ªïng ƒëi·ªÉm t·ªëi ƒëa: 20</strong>
          </div>

          <div class="btn-row">
            <button type="button" class="btn btn-primary" onclick="calculateScore()">
              üß† T√≠nh ƒëi·ªÉm FoMO &amp; l∆∞u l·ªãch s·ª≠
            </button>
            <button type="button" class="btn btn-ghost" onclick="resetForm()">
              üîÑ L√†m l·∫°i t·ª´ ƒë·∫ßu
            </button>
          </div>
        </form>

        <div id="result" class="result">
          <div class="result-title">K·∫øt qu·∫£ FoMO s·ªõm</div>
          <div id="scoreText" class="result-score"></div>
          <div id="levelText" style="font-size: 13px; margin-bottom: 2px;"></div>
          <div id="commentText" style="margin-top: 4px; font-size: 12px; color:#4b5563;"></div>
        </div>

        <p class="footer-note">
          L∆∞u √Ω: C√¥ng c·ª• n√†y kh√¥ng thay th·∫ø cho ch·∫©n ƒëo√°n l√¢m s√†ng. N·∫øu ƒëi·ªÉm cao v√† vi·ªác s·ª≠ d·ª•ng
          m·∫°ng x√£ h·ªôi g√¢y ·∫£nh h∆∞·ªüng r√µ r·ªát ƒë·∫øn h·ªçc t·∫≠p, gi·∫•c ng·ªß ho·∫∑c t√¢m tr·∫°ng, h√£y chia s·∫ª v·ªõi gia ƒë√¨nh,
          gi√°o vi√™n ho·∫∑c chuy√™n gia t√¢m l√Ω.
        </p>
      </section>

      <!-- PANEL HISTORY -->
      <section id="panel-history" style="display:none;">
        <h2>L·ªãch s·ª≠ tr·∫£ l·ªùi (tr√™n m√°y n√†y)</h2>
        <p class="section-desc">
          L·ªãch s·ª≠ ƒë∆∞·ª£c l∆∞u <strong>tr√™n tr√¨nh duy·ªát</strong> ƒëang d√πng.  
          D·ªØ li·ªáu chi ti·∫øt (t√™n + l·ªõp + ƒëi·ªÉm + t·ª´ng c√¢u) ƒë√£ ƒë∆∞·ª£c g·ª≠i l√™n Google Sheets.
        </p>
        <div id="historyContainer"></div>
        <div class="btn-row" style="margin-top: 12px;">
          <button type="button" class="btn btn-ghost" onclick="clearHistory()">
            üóëÔ∏è X√≥a to√†n b·ªô l·ªãch s·ª≠ tr√™n m√°y n√†y
          </button>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Chuy·ªÉn gi·ªØa 2 tab
    function switchTab(tab) {
      const tabTest = document.getElementById("tab-test");
      const tabHistory = document.getElementById("tab-history");
      const panelTest = document.getElementById("panel-test");
      const panelHistory = document.getElementById("panel-history");

      if (tab === "test") {
        tabTest.classList.add("active");
        tabHistory.classList.remove("active");
        panelTest.style.display = "block";
        panelHistory.style.display = "none";
      } else {
        tabTest.classList.remove("active");
        tabHistory.classList.add("active");
        panelTest.style.display = "none";
        panelHistory.style.display = "block";
        renderHistory();
      }
    }

    function resetForm() {
      document.getElementById("fomoForm").reset();
      document.getElementById("result").style.display = "none";
    }

    // G·ª≠i d·ªØ li·ªáu l√™n Google Apps Script (Google Sheets)
    function sendToSheet(entry) {
      const url = "URL_WEB_APP_C·ª¶A_B·∫†N"; // <-- THAY b·∫±ng URL Web App Apps Script

      fetch(url, {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(entry)
      }).catch((err) => {
        console.error("L·ªói khi g·ª≠i l√™n Google Sheets:", err);
      });
    }

    // T√≠nh ƒëi·ªÉm + l∆∞u l·ªãch s·ª≠ + g·ª≠i l√™n Sheets
    function calculateScore() {
      const name = document.getElementById("studentName").value.trim();
      const className = document.getElementById("studentClass").value.trim();

      if (!name) {
        alert("Vui l√≤ng nh·∫≠p H·ªå T√äN ng∆∞·ªùi l√†m kh·∫£o s√°t.");
        return;
      }
      if (!className) {
        alert("Vui l√≤ng nh·∫≠p L·ªöP c·ªßa ng∆∞·ªùi l√†m kh·∫£o s√°t.");
        return;
      }

      let total = 0;
      const answers = [];

      for (let i = 1; i <= 10; i++) {
        const nameQ = "q" + i;
        const checked = document.querySelector(
          'input[name="' + nameQ + '"]:checked'
        );

        if (!checked) {
          alert("Vui l√≤ng tr·∫£ l·ªùi ƒë·∫ßy ƒë·ªß c√¢u " + i + " tr∆∞·ªõc khi t√≠nh ƒëi·ªÉm.");
          return;
        }

        const value = parseInt(checked.value, 10);
        answers.push(value);
        total += value;
      }

      let level = "";
      let badgeClass = "";
      let comment = "";

      if (total <= 6) {
        level = "Th·∫•p";
        badgeClass = "badge-low";
        comment = "Nguy c∆° th·∫•p, s·ª≠ d·ª•ng m·∫°ng x√£ h·ªôi t∆∞∆°ng ƒë·ªëi l√†nh m·∫°nh.";
      } else if (total <= 12) {
        level = "Trung b√¨nh";
        badgeClass = "badge-medium";
        comment =
          "C√≥ d·∫•u hi·ªáu FoMO, n√™n theo d√µi th√™m v√† c√¢n b·∫±ng th·ªùi gian online.";
      } else {
        level = "Cao";
        badgeClass = "badge-high";
        comment =
          "Nguy c∆° FoMO r√µ r·ªát, c·∫ßn h·ªó tr·ª£ k·ªãp th·ªùi v√† ƒëi·ªÅu ch·ªânh th√≥i quen.";
      }

      document.getElementById("result").style.display = "block";
      document.getElementById("scoreText").textContent =
        "T·ªïng ƒëi·ªÉm: " + total + " / 20";
      document.getElementById("levelText").innerHTML =
        'M·ª©c FoMO: <span class="badge ' + badgeClass + '">' + level + "</span>";
      document.getElementById("commentText").textContent = comment;

      // Object d·ªØ li·ªáu ƒë·∫ßy ƒë·ªß
      const entry = {
        date: new Date().toISOString(),
        name: name,
        className: className,
        answers: answers,
        totalScore: total,
        level: level
      };

      // L·ªãch s·ª≠ tr√™n M√ÅY ch·ªâ c·∫ßn l·ªõp + ƒëi·ªÉm
      saveHistoryEntry({
        date: entry.date,
        className: entry.className,
        totalScore: entry.totalScore,
        level: entry.level
      });

      // G·ª≠i ƒë·∫ßy ƒë·ªß l√™n Google Sheets
      sendToSheet(entry);
    }

    // L∆∞u l·ªãch s·ª≠ local
    const HISTORY_KEY = "fomoHistory";

    function getHistory() {
      const raw = localStorage.getItem(HISTORY_KEY);
      if (!raw) return [];
      try {
        return JSON.parse(raw);
      } catch (e) {
        console.error("L·ªói parse history:", e);
        return [];
      }
    }

    function saveHistory(history) {
      localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
    }

    function saveHistoryEntry(entry) {
      const history = getHistory();
      history.unshift(entry);
      saveHistory(history);
    }

    function clearHistory() {
      if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a to√†n b·ªô l·ªãch s·ª≠ tr√™n tr√¨nh duy·ªát n√†y?")) {
        localStorage.removeItem(HISTORY_KEY);
        renderHistory();
      }
    }

    function renderHistory() {
      const container = document.getElementById("historyContainer");
      const history = getHistory();

      if (!history.length) {
        container.innerHTML =
          '<p class="history-empty">Ch∆∞a c√≥ l·ªãch s·ª≠ tr·∫£ l·ªùi n√†o. H√£y l√†m b√†i test, k·∫øt qu·∫£ s·∫Ω ƒë∆∞·ª£c l∆∞u l·∫°i t·∫°i ƒë√¢y.</p>';
        return;
      }

      let html =
        '<table class="history-table"><thead><tr>' +
        "<th>Gi·ªù</th>" +
        "<th>Ng√†y</th>" +
        "<th>L·ªõp</th>" +
        "<th>ƒêi·ªÉm</th>" +
        "<th>M·ª©c FoMO</th>" +
        "</tr></thead><tbody>";

      history.forEach((item) => {
        const date = new Date(item.date);
        const timeStr = date.toLocaleTimeString("vi-VN");
        const dateStr = date.toLocaleDateString("vi-VN");
        const className = item.className || "‚Äî";

        html +=
          "<tr>" +
          "<td>" +
          timeStr +
          "</td>" +
          "<td>" +
          dateStr +
          "</td>" +
          "<td>" +
          className +
          "</td>" +
          '<td><strong>' +
          item.totalScore +
          " / 20</strong></td>" +
          "<td>" +
          item.level +
          "</td>" +
          "</tr>";
      });

      html += "</tbody></table>";
      container.innerHTML = html;
    }

    document.addEventListener("DOMContentLoaded", renderHistory);
  </script>
</body>
</html>
